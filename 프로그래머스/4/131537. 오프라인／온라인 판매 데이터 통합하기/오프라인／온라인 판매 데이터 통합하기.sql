SELECT *
FROM (
    SELECT DATE_FORMAT(SALES_DATE,'%Y-%m-%d') AS SALES_DATE, PRODUCT_ID, USER_ID, SALES_AMOUNT
    FROM ONLINE_SALE
    WHERE SALES_DATE BETWEEN '2022-03-01 00:00:00' AND '2022-03-31 23:59:59'
    
    UNION
    
    SELECT DATE_FORMAT(SALES_DATE,'%Y-%m-%d') AS SALES_DATE, PRODUCT_ID, NULL AS USER_ID, SALES_AMOUNT
    FROM OFFLINE_SALE
    WHERE SALES_DATE BETWEEN '2022-03-01 00:00:00' AND '2022-03-31 23:59:59'
) AS total_sales
 -- WHERE SALES_DATE BETWEEN '2022-03-01 00:00:00' AND '2022-03-31 23:59:59'
 -- DATE_FORMAT을 사용해서 문자열이 되었기 때문에 마지막에 비교 불가함. 그러므로 각 쿼리문 안에서 변환되기 전에 WHERE 절로 먼저 비교해주는 것이 필요함
 --  WHERE SALES_DATE BETWEEN '2022-03-01' AND '2022-03-31 23:59:59'
 ORDER BY SALES_DATE ASC, PRODUCT_ID ASC, USER_ID ASC;